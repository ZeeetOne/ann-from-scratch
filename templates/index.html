<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANN from Scratch - Interactive Neural Network Builder</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üß† ANN from Scratch</h1>
            <p>Interactive Neural Network Builder & Predictor</p>
        </header>

        <div class="main-content">
            <!-- Network Configuration Section -->
            <section class="config-section">
                <h2 class="section-header" onclick="toggleSection('section1')">
                    <span class="section-icon">‚ñº</span>
                    1. Build Network Architecture
                </h2>

                <div id="section1" class="section-content">
                <div class="quick-start">
                    <button id="quickStartMultiClassBtn" class="btn btn-secondary">üìä Multi-Class Example (3-4-2 Softmax)</button>
                    <button id="quickStartBinaryBtn" class="btn btn-secondary">üéØ Binary Example (3-4-1 Sigmoid)</button>
                    <button id="resetNetworkBtn" class="btn btn-secondary">Reset to 1-1-1</button>
                </div>

                <!-- Interactive Network Builder -->
                <div id="networkBuilder" class="network-builder">
                    <div class="builder-header">
                        <h3>Interactive Network Builder</h3>
                        <p class="builder-help">
                            ‚Ä¢ Use +/- buttons to add/remove nodes in each layer<br>
                            ‚Ä¢ Drag from one node to another to create a connection<br>
                            ‚Ä¢ Click on a connection line to edit weight and bias<br>
                            ‚Ä¢ Right-click on a connection to delete it
                        </p>
                    </div>

                    <!-- Layer Controls -->
                    <div class="layer-controls">
                        <div class="layer-control-group">
                            <h4>Input Layer</h4>
                            <div class="node-counter">
                                <button id="inputLayerMinus" class="btn-counter">‚àí</button>
                                <span id="inputLayerCount">1</span>
                                <button id="inputLayerPlus" class="btn-counter">+</button>
                            </div>
                            <select id="inputActivation" class="activation-select-mini">
                                <option value="linear" selected>Linear</option>
                            </select>
                        </div>

                        <div class="layer-control-group">
                            <h4>Hidden Layers</h4>
                            <div id="hiddenLayersControls">
                                <div class="hidden-layer-item" data-layer-index="1">
                                    <div class="hidden-layer-header">
                                        <span class="layer-label">Layer 1:</span>
                                        <div class="node-counter">
                                            <button class="btn-counter hidden-minus" data-layer="1">‚àí</button>
                                            <span class="hidden-count" data-layer="1">1</span>
                                            <button class="btn-counter hidden-plus" data-layer="1">+</button>
                                        </div>
                                        <button class="btn-remove-layer" data-layer="1">‚úï</button>
                                    </div>
                                    <select class="activation-select-mini hidden-activation" data-layer="1">
                                        <option value="sigmoid" selected>Sigmoid</option>
                                        <option value="relu">ReLU</option>
                                        <option value="threshold">Threshold</option>
                                        <option value="softmax">Softmax</option>
                                    </select>
                                </div>
                            </div>
                            <button id="addHiddenLayerBtn" class="btn btn-sm btn-primary">+ Add Hidden Layer</button>
                        </div>

                        <div class="layer-control-group">
                            <h4>Output Layer</h4>
                            <div class="node-counter">
                                <button id="outputLayerMinus" class="btn-counter">‚àí</button>
                                <span id="outputLayerCount">1</span>
                                <button id="outputLayerPlus" class="btn-counter">+</button>
                            </div>
                            <select id="outputActivation" class="activation-select-mini">
                                <option value="sigmoid" selected>Sigmoid</option>
                                <option value="relu">ReLU</option>
                                <option value="threshold">Threshold</option>
                                <option value="linear">Linear</option>
                                <option value="softmax">Softmax</option>
                            </select>
                        </div>
                    </div>

                    <!-- Visual Canvas -->
                    <div id="networkCanvas" class="network-canvas"></div>

                    <div class="diagram-legend">
                        <span class="legend-item"><span class="legend-circle input-node"></span> Input Layer</span>
                        <span class="legend-item"><span class="legend-circle hidden-node"></span> Hidden Layer</span>
                        <span class="legend-item"><span class="legend-circle output-node"></span> Output Layer</span>
                        <span class="legend-item"><span class="legend-line"></span> Connection (drag to create)</span>
                    </div>
                </div>

                <div class="form-actions">
                    <button id="buildNetworkBtn" class="btn btn-success">Build Neural Network</button>
                </div>

                <div id="networkSummary" class="network-summary"></div>
                </div>
            </section>

            <!-- Dataset Section -->
            <section class="dataset-section">
                <h2 class="section-header" onclick="toggleSection('section2')">
                    <span class="section-icon">‚ñº</span>
                    2. Input Dataset
                </h2>

                <div id="section2" class="section-content">

                <div class="dataset-info">
                    <p class="info-text">
                        üìã <strong>Dataset Format:</strong> Input columns must be named <code>x1, x2, x3, ...</code> and output columns <code>y1, y2, y3, ...</code><br>
                        <span id="datasetRequirement"></span>
                    </p>
                </div>

                <div class="dataset-options">
                    <button id="loadExampleBtn" class="btn btn-secondary">Load Example Dataset</button>
                </div>

                <!-- Drag & Drop Zone -->
                <div id="dropZone" class="drop-zone">
                    <div class="drop-zone-content">
                        <span class="drop-icon">üìÅ</span>
                        <p class="drop-text">Drag & Drop CSV file here</p>
                        <p class="drop-subtext">or</p>
                        <label for="fileInput" class="btn btn-primary">Browse Files</label>
                        <input type="file" id="fileInput" accept=".csv" style="display: none;">
                    </div>
                </div>

                <div class="form-group">
                    <label>Dataset Preview:</label>
                    <div id="datasetValidation" class="validation-message"></div>
                    <textarea id="datasetInput" class="form-control dataset-textarea" placeholder="x1,x2,x3,y1,y2
25,1010,85,1,0
30,1015,45,0,1
22,1005,90,1,0
28,1012,50,0,1
20,1000,95,1,0"></textarea>
                    <div class="dataset-stats" id="datasetStats"></div>
                </div>
                </div>
            </section>

            <!-- Forward Pass Section -->
            <section class="forward-pass-section">
                <h2 class="section-header" onclick="toggleSection('section3')">
                    <span class="section-icon">‚ñº</span>
                    3. Forward Pass
                </h2>

                <div id="section3" class="section-content">
                <p class="section-description">See how data flows through the network layers to produce predictions</p>

                <div class="form-actions">
                    <button id="forwardPassBtn" class="btn btn-primary">Run Forward Pass</button>
                </div>

                <div id="forwardPassSummary" class="forward-pass-summary" style="display:none;"></div>
                <div id="forwardPassContainer" class="forward-pass-container"></div>
                </div>
            </section>

            <!-- Loss Function Section -->
            <section class="loss-section">
                <h2 class="section-header" onclick="toggleSection('section4')">
                    <span class="section-icon">‚ñº</span>
                    4. Loss Function
                </h2>

                <div id="section4" class="section-content">
                <p class="section-description">Calculate loss by comparing predictions (≈∑) with targets (Y)</p>

                <!-- Classification Type Info -->
                <div id="classificationInfo" class="info-box" style="display:none;">
                    <strong>‚ÑπÔ∏è Classification Type:</strong> <span id="classificationType"></span><br>
                    <strong>üìã Recommended Loss:</strong> <span id="recommendedLoss"></span>
                </div>

                <div class="form-group">
                    <label>Select Loss Function:</label>
                    <select id="lossFunctionSelect" class="form-control">
                        <option value="mse">Mean Squared Error (MSE)</option>
                        <option value="binary">Binary Cross-Entropy (BCE)</option>
                        <option value="categorical">Categorical Cross-Entropy (CCE)</option>
                    </select>
                </div>

                <div class="form-actions">
                    <button id="calculateLossBtn" class="btn btn-primary">Calculate Loss</button>
                </div>

                <div id="lossContainer" class="loss-container"></div>
                </div>
            </section>

            <!-- Update Weights Section -->
            <section class="update-weights-section">
                <h2 class="section-header" onclick="toggleSection('section5')">
                    <span class="section-icon">‚ñº</span>
                    5. Update Weights (Optimizer)
                </h2>

                <div id="section5" class="section-content">
                <p class="section-description">Update network weights based on gradients - this completes <strong>1 EPOCH</strong></p>
                <div class="info-box">
                    <strong>üìö What is 1 Epoch?</strong><br>
                    1 Epoch = Forward Pass ‚Üí Loss Calculation ‚Üí Backpropagation ‚Üí Weight Update<br>
                    This is one complete cycle through all training samples.
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Optimizer:</label>
                        <select id="updateOptimizer" class="form-control">
                            <option value="gd">Gradient Descent (GD) - Full batch</option>
                            <option value="sgd">Stochastic Gradient Descent (SGD) - Per sample</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Learning Rate (Œ±):</label>
                        <input type="number" id="updateLearningRate" min="0.001" max="10" step="0.01" value="0.1" class="form-control">
                    </div>
                </div>

                <div class="form-actions">
                    <button id="updateWeightsBtn" class="btn btn-primary">Update Weights (1 Epoch)</button>
                </div>

                <div id="updateWeightsContainer" class="update-weights-container"></div>
                </div>
            </section>

            <!-- Automated Training Section -->
            <section class="training-section">
                <h2 class="section-header" onclick="toggleSection('section6')">
                    <span class="section-icon">‚ñº</span>
                    6. Automated Training (Multiple Epochs)
                </h2>

                <div id="section6" class="section-content">
                <p class="section-description">Automate the training process for multiple epochs to achieve better predictions</p>
                <div class="info-box">
                    <strong>üéØ Automated Training</strong><br>
                    This will repeat the entire process (Forward ‚Üí Loss ‚Üí Backprop ‚Üí Update) for many epochs until the model converges.
                </div>

                <div class="training-config">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Optimizer:</label>
                            <select id="optimizer" class="form-control">
                                <option value="gd">Gradient Descent (GD)</option>
                                <option value="sgd">Stochastic Gradient Descent (SGD)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Learning Rate:</label>
                            <input type="number" id="learningRate" min="0.001" max="10" step="0.01" value="0.5" class="form-control">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Epochs:</label>
                            <input type="number" id="epochs" min="10" max="10000" step="10" value="1000" class="form-control">
                        </div>

                        <div class="form-group" id="batchSizeGroup">
                            <label>Batch Size (for SGD, blank = full batch):</label>
                            <input type="number" id="batchSize" min="1" step="1" placeholder="Full batch" class="form-control">
                        </div>
                    </div>

                    <div class="form-actions">
                        <button id="trainBtn" class="btn btn-primary">Start Training</button>
                        <button id="stopTrainingBtn" class="btn btn-danger" style="display:none;">Stop Training</button>
                    </div>
                </div>

                <div id="trainingProgress" class="training-progress" style="display:none;">
                    <h3>Training Progress</h3>
                    <div class="progress-bar">
                        <div id="progressBarFill" class="progress-bar-fill"></div>
                    </div>
                    <p id="progressText">Training in progress...</p>
                </div>

                <div id="trainingResults" class="training-results"></div>
                </div>
            </section>

            <!-- Model Evaluation Section -->
            <section class="evaluation-results-section" id="evaluationResultsSection" style="display:none;">
                <h2 class="section-header" onclick="toggleSection('section7')">
                    <span class="section-icon">‚ñº</span>
                    7. Model Evaluation
                </h2>

                <div id="section7" class="section-content">
                <p class="section-description">Comprehensive evaluation of trained model performance</p>
                <div id="evaluationResults" class="evaluation-results"></div>
                </div>
            </section>
        </div>

        <footer>
            <p>ANN from Scratch - Built with Python & Flask</p>
        </footer>
    </div>

    <!-- Connection Edit Modal -->
    <div id="connectionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Connection</h3>
                <span class="modal-close">&times;</span>
            </div>
            <div class="modal-body">
                <p id="connectionInfo" class="connection-info"></p>
                <div class="form-group">
                    <label>Weight:</label>
                    <input type="number" id="modalWeight" step="0.01" class="form-control">
                </div>
                <div class="form-group">
                    <label>Bias:</label>
                    <input type="number" id="modalBias" step="0.01" class="form-control">
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveConnectionBtn" class="btn btn-primary">Save</button>
                <button id="deleteConnectionBtn" class="btn btn-danger">Delete Connection</button>
                <button id="cancelConnectionBtn" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/network-builder.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
